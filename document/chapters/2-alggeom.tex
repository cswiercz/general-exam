%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Complex Algebraic Geometry --- Period Matrices and the Abel Map}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

This section serves as a brief introduction to the theory of complex
algebraic curves. Primary references are \cite{Ueno97,Griffiths89}.

%..............................................................................
\subsection{The Projective Line}
%..............................................................................

The primary motivation behind complex projective geometry is to make concrete
the way in which we analyze the behavior of functions, such as
polynomials, at infinity without having to resort to techniques separate
from those used at finite points. For example, in applications we may
need to integrate a differential along a path on an algebraic curve
going to infinity. Knowing the geometry of the curve at infinity makes
such an operation computationally feasible.

In fact, anyone with an elementary complex analysis background has seen
an example of projective geometry. The Riemann sphere is the complex
plane $\CC$ with a ``point at infinity'' added. Let $z$ denote the
coordinate in $\CC$ (i.e., the point $z=0$ represents the origin of the
complex plane). In order to discuss the point at infinity we introduce
the coordinate $w = 1/z$. The analysis of some function at $\infty$ is
equivalent to rewriting the problem in terms of the coordinate $w$ and
examining its behavior in a neighborhood of $w=0$. This explains why,
for example, the exponential function
\[
    e^z = \sum_{n=0}^\infty z^n / n!,
\]
though entire in the complex plane, has an essential singularity on the
Riemann sphere since the exponential function in the coordinate $w$
centered at $w=0$ is expressed by the series
\[
    \sum_{n=0}^\infty \frac{w^{-n}}{n!}.
\]

This point at infinity is not rigorously defined because it does not
make sense to {\it equate} $z=\infty$. The definition of the Riemann
sphere is made explicit by the following construction: consider the set
$U = \CC^2 - \{(0,0)\}$. Define the equivalence relation
\[
    (a_0, a_1) \sim (\lambda a_0, \lambda a_1),
    \quad \forall \lambda \in \CC - \{0\}.
\]
Thus two points $(a_0,a_1)$ and $(b_0,b_1)$ in $U$ are considered the
same if the ratios $a_0 : a_1$ and $b_0 : b_1$ are equal. The set of all
points $(b_0,b_1)$ equal to $(a_0,a_1)$ is called the {\it equivalence
  class} of $(a_0,a_1)$ and the {\it complex projective line} $\PP{1}\CC$
is the set of all such equivalence classes. That is,
\[
    \PP{1}\CC := \CC^2 / \sim.
\]
The equivalence class of $(a_0,a_1)$, called a ``point'' in $\PP{1}\CC$,
is written $(a_0 : a_1) \in \PP{1}\CC$. $\PP{1}\CC$ is precisely the
Riemann sphere. To see this, consider the two subsets
\begin{align*}
    U_0 &= \{ (a_0 : a_1) \in \PP{1}\CC \; | \; a_0 \neq 0 \}, \\
    U_1 &= \{ (a_0 : a_1) \in \PP{1}\CC \; | \; a_1 \neq 0 \}.
\end{align*}
For any $(a_0 : a_1) \in U_0$ we have, by the equivalence property,
\[
    (a_0 : a_1) = (1 : a_1/a_0) = (1 : a).
\]
Similarly, $(b_0 : b_1) = (b : 1)$ for every point in $U_1$. Every point
in the intersection $U_0 \cap U_1$ can be written in either of these two
forms. Each of these subspaces are isomorphic to $\CC$ since the maps
\begin{align*}
  \phi_0 : U_0 \to \CC,
  \quad
  \phi_0 \left( (a_0 : a_1) \right) = a_1 / a_0,
  & \quad \text{ and } \\
  \phi_1 : U_1 \to \CC,
  \quad
  \phi_1 \left( (a_0 : a_1) \right) = a_0 / a_1, &
\end{align*}
are continuous bijections with inverses
\begin{gather}
  \phi^{-1}_0(a) = (1 : a), \\
  \phi^{-1}_1(b) = (b : 1).
\end{gather}
Finally, note that $(0 : 1)$ is the only projective point in $U_1$ which
is not in $U_0$. Therefore, we identify $U_0$ with the complex plane (in
the coordinate $z$) and the point $P_\infty = (0 : 1)$ with the point at
infinity and set
\begin{equation} \label{eqn: projective-line}
  \PP{1}\CC = U_0 \cup \{ (0 : 1) \} \cong \CC \cup P_\infty.
\end{equation}

Indeed $P_\infty$ is considered the point at infinity on the Riemann
sphere for if one considers the image of $(0 : 1)$ under $\phi_0$,
though undefined since $(0:1) \not \in U_0$, it maps to $z = 1 / 0$
``='' $\infty$. Again, this does not make sense without the complex
projective space construction above but is merely used to illustrate the
point. The coordinate transformation from $z$ to $w$ at the beginning of
this section is equivalent to identifying $U_1$ with the complex plane
$\CC$ and $\{(1 : 0)\}$ with the point at infinity, instead.

%------------------------------------------------------------------------------
\subsection{The Projective Plane}
%------------------------------------------------------------------------------

The natural environment we use in the sequel is not the complex
projective line but the complex projective plane. In this section we
construct the projective plane and examine its geometric properties. The
construction is similar to that of the projective line.

Let $U = \CC^3 - \{(0,0,0)\}$. Following the strategy of the previous
section, consider the set of all ratios $(a_0 : a_1 : a_2)$, that is,
the collection of all equivalence classes under the equivalence relation
$(a_0 : a_1 : a_2) \sim (\lambda a_0 : \lambda a_1 : \lambda a_2),
\forall \lambda \in \CC - \{0\}$. The space of all such equivalence
classes is called the two-dimensional complex projective space or {\it
  the projective plane} and is denoted $\PP{2}\CC$.

Define the subsets $U_0,U_1,U_2$ by
\[
    U_j = \{ (a_0 : a_1 : a_2) \in \PP{2}\CC \; | \; a_j \neq 0 \},
\]
and note that all $(a_0 : a_1 : a_2) \in U_0$ satisfy $(a_0 : a_1 : a_2)
= (1 : a_1/a_0 : a_2/a_0)$. We define the bijective mapping
\begin{gather*}
    \phi_0 : U_0 \to \CC^2, \\
    \phi_0 \left( (a_0 : a_1 : a_2) \right)
    =
    \left( \frac{a_1}{a_0}, \frac{a_2}{a_0} \right), \\
    \phi_0^{-1} \left( (x,y) \right)
    =
    (1 : x : y).
\end{gather*}
The mappings $\phi_1$ and $\phi_2$ are similarly defined on $U_1$ and
$U_2$, respectively. Therefore, we can identify $U_0$ with the complex
plane $\CC^2$.

Consider the space $U_0^c = \PP{2}\CC - U_0$. By definition, every point
in $U_0^c$ is of the form $(0 : a_1 : a_2)$. By definition, every point
in $U_0^c$ determines a point on the complex projective line
$\PP{1}\CC$. The converse is true as well, resulting in the bijection
\[
    (0 : a_1 : a_2) \in \PP{2}\CC
    \; \leftrightarrow \;
    (a_1 : a_2) \in \PP{1}\CC.
\]
By identifying $U_0^c$ with $\PP{1}\CC$ we may write
\begin{equation} \label{eqn: proejctive-plane}
  \PP{2}\CC = U_0 \cup U_0^c \cong \CC^2 \cup \PP{1}\CC
\end{equation}
where $U_0^c \cong \PP{1}\CC$ is called the {\it line at infinity},
denoted $l_\infty$, and $U_0 \cong \CC^2$ is called the {\it complex
  affine plane}. We may also identify the complex affine plane with the
sets $U_1$ or $U_2$ and the line at infinity with their complements.

We saw a natural geometric interpretation of $\PP{1}\CC$ in the previous
section. Does such an interpretation exist for $\PP{2}\CC$? Consider a line
in the complex affine plane $\CC^2$ which can be written in the form
\[
    \alpha + \beta x + \gamma y = 0,
    \quad \text{where }
    (\beta,\gamma) \neq 0, \alpha, \beta, \gamma \in \CC.
\]
Using the inverse mapping $\phi_0^{-1}$ on $\CC^2$ we have
\[
    x = \frac{x_1}{x_0} \text{ and } y = \frac{x_2}{x_0},
\]
where $(x_0 : x_1 : x_2)$ are the coordinates of $\PP{2}\CC$, and we get
the line
\[
    \alpha x_0 + \beta x_1 + \gamma x_2 = 0.
\]
This equation, called the {\it homogenization} of the affine curve,
makes sense in all of $\PP{2}\CC$. Setting $x_0 = 1$ gives the original
affine line. On the other hand, setting $x_0 = 0$ gives the equation
\[
    \beta x_1 + \gamma x_2 = 0,
\]
which is the equation of the line in $l_\infty$. However, this implies
$x_1 / x_2 = - \gamma / \beta$. Hence the projective point $(0 : -\gamma
: \beta)$ satisfies the equation
\[
    \alpha x_0 + \beta x_1 + \gamma x_2 = 0
\]
and is, in fact, the only projective point in $l_\infty$ on the line.

This means that the line ``intersects'' $l_\infty$ at the point $(0 :
-\gamma : \beta)$ and that this intersection point depends only on the
slope of the affine portion of the line. Hence, the line at infinity has
the geometric meaning that each point on it is the intersection point of
an entire family of parallel lines in $\CC^2$. This leads to a
generalization of a theorem from classical planar geometry: {\it any
  two, distinct lines in $\PP{2}\CC$ intersect at exactly one point}.

%------------------------------------------------------------------------------
\subsection{Projective Plane Curves}
%------------------------------------------------------------------------------

The set of all points $(x_0, x_1, x_2)$ satisfying
\[
    \alpha x_0 + \beta x_1 + \gamma x_2 = 0
\]
is called a projective line and is a simple example of a projective
algebraic curve (of degree one). In this section we introduce various
properties of general projective curves.

An {\it complex plane algebraic curve} is the zero locus of the
homogenization of a polynomial $f \in \CC[x,y]$. That is, given a
polynomial $f(x,y) = \alpha_n(x) y^n + \alpha_{n-1}(x)y^{n-1} + \cdots +
\alpha_0(x)$ its homogenization is the polynomial $F \in
\PP{2}\CC[x_0,x_1,x_2]$ where
\[
    F(x_0,x_1,x_2) = x_0^d f(x_1/x_0,x_2/x_0).
\]
where $d$ is the degree of $F$. The homogeneity of $F$ means that we can
write
\[
    F(x_0,x_1,x_2) = \sum_{i+j+k=d} \alpha_{ijk} x_0^i x_1^j x_2^k.
\]

In terms of the projective polynomial $F$, its affine part can be
written $f(x,y) = F(1,x,y)$. As in the case of a projective line, $f$
can be thought of as a projection of the polynomial $F$ onto $\CC^2$ and
there is always a one-to-one correspondence between an affine polynomial
and its homogenization. Therefore, a {\it complex plane algebraic curve}
is the set
\[
  C = \left\{
  (x_0 : x_1 : x_2) \in \PP{2}\CC : F(x_0,x_1,x_2) = 0
  \right\}.
\]

Important to the study of projective curves, and specifically in the
computational work described here, are singular points. A point $a =
(a_0 : a_1 : a_2) \in C$ is a {\it singular point of $C$}, or a {\it
  multiple point of $C$}, if
\[
  \left(
    \frac{\partial F}{\partial x_0},
    \frac{\partial F}{\partial x_1},
    \frac{\partial F}{\partial x_2}
  \right) (a)
  = (0,0,0).
\]
Consider the case when $a = (1 : 0 : 0)$ (corresponding to the point
$(0,0)$ in the affine plane $\CC^2$) is a singular point of $F$. The
affine poirtion of the curve is
\[
f(x,y) = \sum_{i+j \geq 2}^d c_{ij} x^iy^j.
\]
Note that the constant term is zero since $(0, 0)$ is a point on the
affine curve and the linear term vanishes since $(0,0)$ is a singular
point. We write
\[
  f(x,y) = f_m(x,y) + f_{m+1}(x,y) + \cdots + f_d(x,y), \quad m \geq 2,
\]
where each $f_n$ is the sum of all terms of $f$ of degree $n$; that is,
terms of the form $c_{ij}x^iy^j$ such that $i+j=n$. The smallest such
$m$ with non-zero term $f_m$ appearing in $f$ is called the {\it
  multiplicity} of the singular point $(1 : 0 : 0)$. Singularities with
multiplicity two are called {\it double points}, those with multiplicity
three are called {\it triple points}, and so on.

The homogeneous term $f_m$ can be factored into linear factors
\[
  f_m(x,y) = \prod_{j=1}^m (\alpha_j x - \beta_j y).
\]
We call the space $f_m(x,y) = 0$ the {\it tangent cone of the plane
  curve $C$} at $a = (1 : 0 : 0)$ consistsing of a finite number of
intersecting lines $L_j : \alpha_j x - \beta_j y$.

When a generic affine point $a = (1 : c : d)$ is a singular point we
write the affine curve in the form
\[
    f(x,y) = \sum_{i+j \geq 2}^d \tilde{c}_{ij} (x-c)^i(y-d)^j
\]
which we can write as a sum of polynomials $g_n(x-c,y-d)$ homogenous in
$x-c$ and $y-d$.

In the case when the singular point $a = (0 : 1 : b) \in l_\infty$ we
repeat the above process with the affine curve
\[
    g(u,v) = \frac{1}{x_1^d} F(x_0, x_1, x_2) = F(u,1,v),
    \quad u = \frac{x_0}{x_1}, v = \frac{x_2}{x_1},
\]
which is a projection of $F$ onto $U_1 \cong \CC$ instead of $U_0$.  We
write $g$ as a sum of terms of the form $g_{ij}u^i(v-b)^j$. Finally, in
the case $a = (0 : 0 : 1) \in l_\infty$ we use the affine curve
\[
    h(w,z) = \frac{1}{x_2^d} F(x_0, x_1, x_2) = F(w,z,1),
    \quad w = \frac{x_0}{x_2}, z = \frac{x_1}{x_2},
\]
and write $h$ as a sum of terms of the form $h_{ij}w^iz^j$.

\begin{example} \label{ex: cubic}
Consider the cubic curve
\[
    C: F(x_0,x_1,x_2) =
    x_0^4 x_2^3 + 2 x_0^3 x_1^3 x_2 - x_1^7
\]
In complex affine space $x_0 = 1$ this curve is
\[
    f(x,y) = F(1,x,y) = y^3 + 2 x^3 y - x^7.
\]
A plot of $f$ for $x,y$ real is shown in Figure \ref{fig: example-cubic}.
For $a = (a_0 : a_1 : a_2)$ we have
\begin{align} \label{eq: singular-conditions}
    \frac{\partial F}{\partial x_0}(a)
    &=
    4 a_{0}^{3} a_{2}^{3} + 6 a_{0}^{2} a_{1}^{3} a_{2}, \notag \\
    \frac{\partial F}{\partial x_1}(a)
    &=
    6 a_{0}^{3} a_{1}^{2} a_{2} - 7 a_{1}^{6}, \notag \\
    \frac{\partial F}{\partial x_2}(a)
    &=
    3 a_{0}^{4} a_{2}^{2} + 2 a_{0}^{3} a_{1}^{3}.
\end{align}

\begin{figure}
  \centering
  \includegraphics[width=0.8\textwidth]{images/2_example_curve.png}
  \caption{A real plot of the curve $f(x,y) = y^3 + 2 x^3 y - x^7$.}
  \label{fig: example-cubic}
\end{figure}

First, we find the finite singular points of $C$. Setting $a_0=1$ and
solving the above equations for $a_1$ and $a_2$ we see that $p = (1 : 0
: 0)$ is the only finite singular point of $F$. Note that
\begin{gather*}
    f(x,y) = f_3(x,y) + f_4(x,y) + f_7(x,y) \\
    f_3(x,y) = y^3, \; \;
    f_4(x,y) = 2 x^3 y, \; \;
    f_7(x,y) = -x^7,
\end{gather*}
and that $f_3$, $f_4$, and $f_7$ are homogeneous of degrees 3, 4, and 7,
respectively. Therefore, $p$ is a singular point of multiplicity 3 with
\[
    f_3(x,y) = y^3 = 0,
\]
as the equation for the tangent cone at $p$. These properties are
suggested by Figure \ref{fig: example-cubic} where, near the point $p$,
the real curve looks like the intersection of three curves well
approximated by the line $y = 0$ at $x = 0$.

Setting $a_0 = 0$, the only expression in Equation \eqref{eq:
  singular-conditions} that does not reduce to zero is
\[
    \frac{\partial F}{\partial x_1}((0,a_1,a_2))
    =
    - 7 a_{1}^{6} = 0,
\]
implying that the point $a = (0 : 0 : 1)$ is the only singular point at
infinity. The curve at infinity centered at $(0 : 0 : 1)$ is
\[
    h(w,z) = F(w,z,1) = w^{4} + 2 w^{3} z^{3} - z^{7}.
\]
The order of this singularity is four since this is the degree of the
lowest degree homogeneous term. The tangent cone at $a$ is $g_4(w,z) =
w^4$.
\end{example}


%------------------------------------------------------------------------------
\subsection{Connection to Riemann Surfaces}
%------------------------------------------------------------------------------

There is a close relationship between the study of compact Riemann
surfaces and that of algebraic curves. Recall that a Riemann surface
$\tilde{C}$ is a complex manifold of complex dimension one endowed with
an {\it atlas}: an open covering $\{U_\alpha \}_{\alpha \in A}$ of
$\tilde{C}$ together with a collection of homeomorphisms $\{z_\alpha :
U_\alpha \to \CC\}_{\alpha \in A}$, called {\it local parameters}, such
that every pair of {\it transition functions}
\[
    f_{\beta,\alpha} := z_\beta \circ z_\alpha^{-1} :
    z_\alpha \left( U_\alpha \cap U_\beta \right)
    \to
    z_\beta \left( U_\alpha \cap U_\beta \right),
\]
is holomorphic. The pairs $(U_\alpha, z_\alpha)$ are called {\it
  coordinate charts}. In other words, a Riemann surface is a topological
space such that for all points $P \in \tilde{C}$ there is a neighborhood
of $P$ homeomorphic to an open subset of the complex plane and one can
analytically continue along the surface via transition functions.

The Riemann sphere $\tilde{C} = \CC^*$ is an example of a Riemann
surface. Its atlas consists of two coordinate charts $(U_1, z_1)$ and
$(U_2, z_2)$ with
\begin{align*}
    U_1 = \CC, & \quad z_1 = z, \\
    U_2 = \left( \CC - \{0\} \right) \cup \{ \infty \}, & \quad z_2 = 1/z.
\end{align*}
This is a valid atlas since the transition functions
\begin{gather*}
    f_{1,2}, f_{2,1} : \CC - \{0\} \to \CC - \{0\} \\
    f_{1,2} = z_1 \circ z_2^{-1} = 1/z \\
    f_{2,1} = z_2 \circ z_1^{-1} = 1/z
\end{gather*}
are holomorphic on $U_1 \cap U_2 = \CC - \{0\}$.

This relationship between curves and Riemann surfaces are embodied by
the following two theorems \cite{Griffiths89}.

\begin{theorem} \label{thm: normalization}
  {\it (Normalization Theorem.)} For any irreducible algebraic curve $C
  \subset \PP{2}\CC$ there exists a compact Riemann surface $\tilde{C}$ and
  a holomorphic mapping
  \[
      \sigma : \tilde{C} \to \PP{2}\CC,
  \]
  such that $\sigma( \tilde{C} ) = C$ and $\sigma$ is injective on the
  inverse image of the set of smooth points of $C$.
\end{theorem}

A Riemann surface together with the mapping $\sigma$ is called the {\it
  normalization of $C$}. Loosely speaking, the normalization theorem
states that an algebraic curve is a Riemann surface except at the
singular points.

Conversely, every compact Riemann surface can be represented by an
algebraic curve.

\begin{theorem} \label{thm: repr-theorem}
  Any compact Riemann surface $\tilde{C}$ can be obtained through the
  normalization of a certain plane algebraic curve $C$ with at most
  ordinary double points. That is, there exists a holomorphic mapping
  \[
      \sigma : \tilde{C} \to \PP{2}\CC
  \]
  such that $\sigma(\tilde{C})$ is an algebraic curve possessing at most
  ordinary double points.
\end{theorem}

In the algorithms presented in this document we primarily work with the
affine part $f(x,y)$ of the curve $F(x_0,y_0,z_0)$. If analysis on the
line at infinity is necessary, when computing singular points for
example, we consider an affine projection $g$ of $F$ onto $l_\infty$,
\[
    g(u,y) = u^d f(1/u,y) = 0.
\]
Thus, the Riemann surface considered here is the branched algebraic
$y$-covering of the complex $x$-Riemann sphere. That is, the set of all
$(x,y)$-solutions $\tilde{C}$ to the affine polynomial equation
\[
    f(x,y) = \alpha_d(x)y^d + \alpha_{d-1}y^{d-1} + \cdots +
             \alpha_1(x)y + \alpha_0(x) = 0
\]
as $x$ varies along all of $\PP{1}\CC$. We treat $x$ and $y$ as the
independent and dependent variables of the equation, respectively.

A {\it point} $\alpha \in \CC$ is called a {\it regular point of $f$} if
\[
    f(\alpha,y) = 0
\]
has $d$ distinct $y$-roots $y_0,\ldots,y_{d-1}$. A point $\alpha \in
\CC$ is called a discriminant point if it in not regular. $\alpha =
\infty$ is a regular point of $f$ if
\[
    g(0,y)
\]
has $d$ disctinct roots.

A {\it place} $P$ is an element of $\tilde{C}$. For all but finitely
many places, $P$ is given by a pair $(\alpha,\beta)$ such that
$f(\alpha,\beta) = 0$. However, some places, particularly those where
$\alpha$ is a discriminant point, need instead be represented by a pair
of series $(x(t),y(t))$ in some local coordinate $t$. This will be
discussed in more detail in the following chapter.
